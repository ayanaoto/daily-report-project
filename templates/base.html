{% load static %}
<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>{% block title %}FieldNote{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
      /* テーマスタイル */
      :root{
        --fn-page-bg: #f8f9fa;
        --fn-text:    #212529;
        --fn-header:  #417690;
        --fn-accent:  #79aec8;
        --fn-accent-2:#2a6078;
        --fn-accent-h:#195c77;
        --fn-input-bg:#ffffff;
        --fn-input-tx:#0b0f14;
        --fn-input-bd:#334155;
        --fn-input-ph:#6b7280;
        --fn-link:#1f4d66;
        --fn-link-h:#14394d;
      }
      body{
        background: var(--fn-page-bg);
        color: var(--fn-text);
      }
      a{ color: var(--fn-link); text-decoration: none; }
      a:hover{ color: var(--fn-link-h); }
      .navbar{
        background: var(--fn-header) !important;
        border-bottom: 0 !important;
      }
      .navbar .navbar-brand,
      .navbar .nav-link{ color:#eef7fb !important; }
      .navbar .nav-link:hover{ color:#ffffff !important; }
      .card{ background:#fff; border:1px solid #dee2e6; }
      .card-header{
        background: var(--fn-accent);
        border-bottom:0;
        color:#fff;
        font-weight:600;
      }
      .form-control,
      .form-select,
      .input-group-text{
        background: var(--fn-input-bg) !important;
        color: var(--fn-input-tx) !important;
        border: 2px solid var(--fn-input-bd) !important;
      }
      .form-control::placeholder{ color: var(--fn-input-ph) !important; }
      .form-control:focus,
      .form-select:focus{
        outline:0;
        border-color: var(--fn-accent-2) !important;
        box-shadow: 0 0 0 .2rem rgba(41,97,120,.20);
      }
      .form-label{ color:#0f172a; font-weight:600; }
      .btn-primary{
        background: var(--fn-accent-2) !important;
        border-color: var(--fn-accent-2) !important;
        color:#fff !important;
      }
      .btn-primary:hover{
        background: var(--fn-accent-h) !important;
        border-color: var(--fn-accent-h) !important;
      }
      .btn-success{
        background:#2b6e3f !important;
        border-color:#2b6e3f !important;
        color:#fff !important;
      }
      .btn-success:hover{
        background:#225a33 !important;
        border-color:#225a33 !important;
      }
      .btn-outline-light{
        color:#fff !important;
        border-color: #fff !important;
      }
      .btn-outline-light:hover{
        background: rgba(255, 255, 255, 0.15) !important;
        color:#fff !important;
      }
      .btn-outline-secondary{
        color:#0f172a !important;
        border-color:#334155 !important;
      }
      .btn-outline-secondary:hover{
        background:#e6f2f7 !important;
        color:#0b0f14 !important;
      }
      .table thead th{
        background: var(--fn-accent-2) !important;
        color:#fff !important;
        border-bottom:0 !important;
      }
      footer{ color: #6c757d; }
    </style>

    {% block extra_head %}{% endblock %}
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
      <div class="container">
        <a class="navbar-brand fw-bold" href="{% url 'reports:report_list' %}">FieldNote</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="mainNav">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="{% url 'reports:report_list' %}">日報一覧</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'reports:customer_list' %}">顧客</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'reports:deal_list' %}">案件</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'reports:troubleshooting_list' %}">トラブルシュート</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'reports:todo_list' %}">ToDo</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'reports:voice_logger' %}">音声ログ</a></li>
          </ul>

          <div class="d-flex align-items-center gap-2">
            <a class="btn btn-success" href="{% url 'reports:report_create' %}">＋日報</a>

            {% if user.is_authenticated %}
              <div class="dropdown">
                <button class="btn btn-outline-light dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                  {{ user.username }}
                </button>
                <ul class="dropdown-menu dropdown-menu-end">
                  <li><a class="dropdown-item" href="{% url 'reports:profile' %}">プロフィール</a></li>
                  {% if user.is_staff %}
                  <li><a class="dropdown-item" href="{% url 'admin:index' %}">管理サイト</a></li>
                  {% endif %}
                  <li><hr class="dropdown-divider"></li>
                  <li>
                    <form action="{% url 'logout' %}" method="post" class="px-2 py-1">
                      {% csrf_token %}
                      <button type="submit" class="btn btn-sm btn-outline-danger w-100">ログアウト</button>
                    </form>
                  </li>
                </ul>
              </div>
            {% else %}
              <a class="btn btn-outline-light" href="{% url 'login' %}">ログイン</a>
              <a class="btn btn-primary" href="{% url 'signup' %}">新規登録</a>
            {% endif %}
          </div>
        </div>
      </div>
    </nav>

    <main class="container py-4">
      {% block content %}{% endblock %}
    </main>

    <footer class="border-top py-4 mt-4">
      <div class="container d-flex justify-content-between small">
        <span>© FieldNote</span>
        <span>v1.0</span>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    {% block extra_js %}{% endblock %}
  </body>
</html>